ea0ce7d62f27cd98947a5b2559557023
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));
var _get2 = _interopRequireDefault(require("@babel/runtime/helpers/get"));
var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var _RendererProxy = require("../../ReactNative/RendererProxy");
var _AnimatedEvent = require("../AnimatedEvent");
var _NativeAnimatedHelper = _interopRequireDefault(require("../NativeAnimatedHelper"));
var _AnimatedNode2 = _interopRequireDefault(require("./AnimatedNode"));
var _AnimatedObject = _interopRequireWildcard(require("./AnimatedObject"));
var _AnimatedStyle = _interopRequireDefault(require("./AnimatedStyle"));
var _invariant = _interopRequireDefault(require("invariant"));
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != typeof e && "function" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }
function _callSuper(t, o, e) { return o = (0, _getPrototypeOf2.default)(o), (0, _possibleConstructorReturn2.default)(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], (0, _getPrototypeOf2.default)(t).constructor) : o.apply(t, e)); }
function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }
function createAnimatedProps(inputProps) {
  var props = {};
  for (var key in inputProps) {
    var value = inputProps[key];
    if (key === 'style') {
      props[key] = new _AnimatedStyle.default(value);
    } else if (value instanceof _AnimatedNode2.default) {
      props[key] = value;
    } else if ((0, _AnimatedObject.hasAnimatedNode)(value)) {
      props[key] = new _AnimatedObject.default(value);
    } else {
      props[key] = value;
    }
  }
  return props;
}
var AnimatedProps = exports.default = function (_AnimatedNode) {
  function AnimatedProps(props, callback) {
    var _this;
    (0, _classCallCheck2.default)(this, AnimatedProps);
    _this = _callSuper(this, AnimatedProps);
    _this._props = createAnimatedProps(props);
    _this._callback = callback;
    return _this;
  }
  (0, _inherits2.default)(AnimatedProps, _AnimatedNode);
  return (0, _createClass2.default)(AnimatedProps, [{
    key: "__getValue",
    value: function __getValue() {
      var props = {};
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof _AnimatedNode2.default) {
          props[key] = value.__getValue();
        } else if (value instanceof _AnimatedEvent.AnimatedEvent) {
          props[key] = value.__getHandler();
        } else {
          props[key] = value;
        }
      }
      return props;
    }
  }, {
    key: "__getAnimatedValue",
    value: function __getAnimatedValue() {
      var props = {};
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof _AnimatedNode2.default) {
          props[key] = value.__getAnimatedValue();
        }
      }
      return props;
    }
  }, {
    key: "__attach",
    value: function __attach() {
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof _AnimatedNode2.default) {
          value.__addChild(this);
        }
      }
    }
  }, {
    key: "__detach",
    value: function __detach() {
      if (this.__isNative && this._animatedView) {
        this.__disconnectAnimatedView();
      }
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof _AnimatedNode2.default) {
          value.__removeChild(this);
        }
      }
      (0, _get2.default)((0, _getPrototypeOf2.default)(AnimatedProps.prototype), "__detach", this).call(this);
    }
  }, {
    key: "update",
    value: function update() {
      this._callback();
    }
  }, {
    key: "__makeNative",
    value: function __makeNative(platformConfig) {
      for (var key in this._props) {
        var value = this._props[key];
        if (value instanceof _AnimatedNode2.default) {
          value.__makeNative(platformConfig);
        }
      }
      if (!this.__isNative) {
        this.__isNative = true;
        (0, _get2.default)((0, _getPrototypeOf2.default)(AnimatedProps.prototype), "__setPlatformConfig", this).call(this, platformConfig);
        if (this._animatedView) {
          this.__connectAnimatedView();
        }
      }
    }
  }, {
    key: "setNativeView",
    value: function setNativeView(animatedView) {
      if (this._animatedView === animatedView) {
        return;
      }
      this._animatedView = animatedView;
      if (this.__isNative) {
        this.__connectAnimatedView();
      }
    }
  }, {
    key: "__connectAnimatedView",
    value: function __connectAnimatedView() {
      (0, _invariant.default)(this.__isNative, 'Expected node to be marked as "native"');
      var nativeViewTag = (0, _RendererProxy.findNodeHandle)(this._animatedView);
      (0, _invariant.default)(nativeViewTag != null, 'Unable to locate attached view in the native tree');
      _NativeAnimatedHelper.default.API.connectAnimatedNodeToView(this.__getNativeTag(), nativeViewTag);
    }
  }, {
    key: "__disconnectAnimatedView",
    value: function __disconnectAnimatedView() {
      (0, _invariant.default)(this.__isNative, 'Expected node to be marked as "native"');
      var nativeViewTag = (0, _RendererProxy.findNodeHandle)(this._animatedView);
      (0, _invariant.default)(nativeViewTag != null, 'Unable to locate attached view in the native tree');
      _NativeAnimatedHelper.default.API.disconnectAnimatedNodeFromView(this.__getNativeTag(), nativeViewTag);
    }
  }, {
    key: "__restoreDefaultValues",
    value: function __restoreDefaultValues() {
      if (this.__isNative) {
        _NativeAnimatedHelper.default.API.restoreDefaultValues(this.__getNativeTag());
      }
    }
  }, {
    key: "__getNativeConfig",
    value: function __getNativeConfig() {
      var propsConfig = {};
      for (var propKey in this._props) {
        var value = this._props[propKey];
        if (value instanceof _AnimatedNode2.default) {
          value.__makeNative(this.__getPlatformConfig());
          propsConfig[propKey] = value.__getNativeTag();
        }
      }
      return {
        type: 'props',
        props: propsConfig
      };
    }
  }]);
}(_AnimatedNode2.default);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiZGVmYXVsdCIsIl9jbGFzc0NhbGxDaGVjazIiLCJfY3JlYXRlQ2xhc3MyIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yIiwiX2dldDIiLCJfZ2V0UHJvdG90eXBlT2YyIiwiX2luaGVyaXRzMiIsIl9SZW5kZXJlclByb3h5IiwiX0FuaW1hdGVkRXZlbnQiLCJfTmF0aXZlQW5pbWF0ZWRIZWxwZXIiLCJfQW5pbWF0ZWROb2RlMiIsIl9BbmltYXRlZE9iamVjdCIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiX0FuaW1hdGVkU3R5bGUiLCJfaW52YXJpYW50IiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwiZSIsIldlYWtNYXAiLCJyIiwidCIsIl9fZXNNb2R1bGUiLCJoYXMiLCJnZXQiLCJuIiwiX19wcm90b19fIiwiYSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsInUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpIiwic2V0IiwiX2NhbGxTdXBlciIsIm8iLCJfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0IiwiUmVmbGVjdCIsImNvbnN0cnVjdCIsImNvbnN0cnVjdG9yIiwiYXBwbHkiLCJCb29sZWFuIiwicHJvdG90eXBlIiwidmFsdWVPZiIsImNyZWF0ZUFuaW1hdGVkUHJvcHMiLCJpbnB1dFByb3BzIiwicHJvcHMiLCJrZXkiLCJBbmltYXRlZFN0eWxlIiwiQW5pbWF0ZWROb2RlIiwiaGFzQW5pbWF0ZWROb2RlIiwiQW5pbWF0ZWRPYmplY3QiLCJBbmltYXRlZFByb3BzIiwiX0FuaW1hdGVkTm9kZSIsImNhbGxiYWNrIiwiX3RoaXMiLCJfcHJvcHMiLCJfY2FsbGJhY2siLCJfX2dldFZhbHVlIiwiQW5pbWF0ZWRFdmVudCIsIl9fZ2V0SGFuZGxlciIsIl9fZ2V0QW5pbWF0ZWRWYWx1ZSIsIl9fYXR0YWNoIiwiX19hZGRDaGlsZCIsIl9fZGV0YWNoIiwiX19pc05hdGl2ZSIsIl9hbmltYXRlZFZpZXciLCJfX2Rpc2Nvbm5lY3RBbmltYXRlZFZpZXciLCJfX3JlbW92ZUNoaWxkIiwidXBkYXRlIiwiX19tYWtlTmF0aXZlIiwicGxhdGZvcm1Db25maWciLCJfX2Nvbm5lY3RBbmltYXRlZFZpZXciLCJzZXROYXRpdmVWaWV3IiwiYW5pbWF0ZWRWaWV3IiwiaW52YXJpYW50IiwibmF0aXZlVmlld1RhZyIsImZpbmROb2RlSGFuZGxlIiwiTmF0aXZlQW5pbWF0ZWRIZWxwZXIiLCJBUEkiLCJjb25uZWN0QW5pbWF0ZWROb2RlVG9WaWV3IiwiX19nZXROYXRpdmVUYWciLCJkaXNjb25uZWN0QW5pbWF0ZWROb2RlRnJvbVZpZXciLCJfX3Jlc3RvcmVEZWZhdWx0VmFsdWVzIiwicmVzdG9yZURlZmF1bHRWYWx1ZXMiLCJfX2dldE5hdGl2ZUNvbmZpZyIsInByb3BzQ29uZmlnIiwicHJvcEtleSIsIl9fZ2V0UGxhdGZvcm1Db25maWciLCJ0eXBlIl0sInNvdXJjZXMiOlsiQW5pbWF0ZWRQcm9wcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZsb3dcbiAqIEBmb3JtYXRcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCB0eXBlIHtQbGF0Zm9ybUNvbmZpZ30gZnJvbSAnLi4vQW5pbWF0ZWRQbGF0Zm9ybUNvbmZpZyc7XG5cbmltcG9ydCB7ZmluZE5vZGVIYW5kbGV9IGZyb20gJy4uLy4uL1JlYWN0TmF0aXZlL1JlbmRlcmVyUHJveHknO1xuaW1wb3J0IHtBbmltYXRlZEV2ZW50fSBmcm9tICcuLi9BbmltYXRlZEV2ZW50JztcbmltcG9ydCBOYXRpdmVBbmltYXRlZEhlbHBlciBmcm9tICcuLi9OYXRpdmVBbmltYXRlZEhlbHBlcic7XG5pbXBvcnQgQW5pbWF0ZWROb2RlIGZyb20gJy4vQW5pbWF0ZWROb2RlJztcbmltcG9ydCBBbmltYXRlZE9iamVjdCwge2hhc0FuaW1hdGVkTm9kZX0gZnJvbSAnLi9BbmltYXRlZE9iamVjdCc7XG5pbXBvcnQgQW5pbWF0ZWRTdHlsZSBmcm9tICcuL0FuaW1hdGVkU3R5bGUnO1xuaW1wb3J0IGludmFyaWFudCBmcm9tICdpbnZhcmlhbnQnO1xuXG5mdW5jdGlvbiBjcmVhdGVBbmltYXRlZFByb3BzKGlucHV0UHJvcHM6IE9iamVjdCk6IE9iamVjdCB7XG4gIGNvbnN0IHByb3BzOiBPYmplY3QgPSB7fTtcbiAgZm9yIChjb25zdCBrZXkgaW4gaW5wdXRQcm9wcykge1xuICAgIGNvbnN0IHZhbHVlID0gaW5wdXRQcm9wc1trZXldO1xuICAgIGlmIChrZXkgPT09ICdzdHlsZScpIHtcbiAgICAgIHByb3BzW2tleV0gPSBuZXcgQW5pbWF0ZWRTdHlsZSh2YWx1ZSk7XG4gICAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkTm9kZSkge1xuICAgICAgcHJvcHNba2V5XSA9IHZhbHVlO1xuICAgIH0gZWxzZSBpZiAoaGFzQW5pbWF0ZWROb2RlKHZhbHVlKSkge1xuICAgICAgcHJvcHNba2V5XSA9IG5ldyBBbmltYXRlZE9iamVjdCh2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHByb3BzW2tleV0gPSB2YWx1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHByb3BzO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBbmltYXRlZFByb3BzIGV4dGVuZHMgQW5pbWF0ZWROb2RlIHtcbiAgX3Byb3BzOiBPYmplY3Q7XG4gIF9hbmltYXRlZFZpZXc6IGFueTtcbiAgX2NhbGxiYWNrOiAoKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBPYmplY3QsIGNhbGxiYWNrOiAoKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9wcm9wcyA9IGNyZWF0ZUFuaW1hdGVkUHJvcHMocHJvcHMpO1xuICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG4gIH1cblxuICBfX2dldFZhbHVlKCk6IE9iamVjdCB7XG4gICAgY29uc3QgcHJvcHM6IHtbc3RyaW5nXTogYW55IHwgKCguLi5hcmdzOiBhbnkpID0+IHZvaWQpfSA9IHt9O1xuICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuX3Byb3BzKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuX3Byb3BzW2tleV07XG4gICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBbmltYXRlZE5vZGUpIHtcbiAgICAgICAgcHJvcHNba2V5XSA9IHZhbHVlLl9fZ2V0VmFsdWUoKTtcbiAgICAgIH0gZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBBbmltYXRlZEV2ZW50KSB7XG4gICAgICAgIHByb3BzW2tleV0gPSB2YWx1ZS5fX2dldEhhbmRsZXIoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByb3BzW2tleV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcHJvcHM7XG4gIH1cblxuICBfX2dldEFuaW1hdGVkVmFsdWUoKTogT2JqZWN0IHtcbiAgICBjb25zdCBwcm9wczoge1tzdHJpbmddOiBhbnl9ID0ge307XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5fcHJvcHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5fcHJvcHNba2V5XTtcbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkTm9kZSkge1xuICAgICAgICBwcm9wc1trZXldID0gdmFsdWUuX19nZXRBbmltYXRlZFZhbHVlKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwcm9wcztcbiAgfVxuXG4gIF9fYXR0YWNoKCk6IHZvaWQge1xuICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuX3Byb3BzKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuX3Byb3BzW2tleV07XG4gICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBbmltYXRlZE5vZGUpIHtcbiAgICAgICAgdmFsdWUuX19hZGRDaGlsZCh0aGlzKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfX2RldGFjaCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fX2lzTmF0aXZlICYmIHRoaXMuX2FuaW1hdGVkVmlldykge1xuICAgICAgdGhpcy5fX2Rpc2Nvbm5lY3RBbmltYXRlZFZpZXcoKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5fcHJvcHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5fcHJvcHNba2V5XTtcbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkTm9kZSkge1xuICAgICAgICB2YWx1ZS5fX3JlbW92ZUNoaWxkKHRoaXMpO1xuICAgICAgfVxuICAgIH1cbiAgICBzdXBlci5fX2RldGFjaCgpO1xuICB9XG5cbiAgdXBkYXRlKCk6IHZvaWQge1xuICAgIHRoaXMuX2NhbGxiYWNrKCk7XG4gIH1cblxuICBfX21ha2VOYXRpdmUocGxhdGZvcm1Db25maWc6ID9QbGF0Zm9ybUNvbmZpZyk6IHZvaWQge1xuICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuX3Byb3BzKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuX3Byb3BzW2tleV07XG4gICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBbmltYXRlZE5vZGUpIHtcbiAgICAgICAgdmFsdWUuX19tYWtlTmF0aXZlKHBsYXRmb3JtQ29uZmlnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuX19pc05hdGl2ZSkge1xuICAgICAgdGhpcy5fX2lzTmF0aXZlID0gdHJ1ZTtcblxuICAgICAgLy8gU2luY2UgdGhpcyBkb2VzIG5vdCBjYWxsIHRoZSBzdXBlci5fX21ha2VOYXRpdmUsIHdlIG5lZWQgdG8gc3RvcmUgdGhlXG4gICAgICAvLyBzdXBwbGllZCBwbGF0Zm9ybUNvbmZpZyBoZXJlLCBiZWZvcmUgY2FsbGluZyBfX2Nvbm5lY3RBbmltYXRlZFZpZXdcbiAgICAgIC8vIHdoZXJlIGl0IHdpbGwgYmUgbmVlZGVkIHRvIHRyYXZlcnNlIHRoZSBncmFwaCBvZiBhdHRhY2hlZCB2YWx1ZXMuXG4gICAgICBzdXBlci5fX3NldFBsYXRmb3JtQ29uZmlnKHBsYXRmb3JtQ29uZmlnKTtcblxuICAgICAgaWYgKHRoaXMuX2FuaW1hdGVkVmlldykge1xuICAgICAgICB0aGlzLl9fY29ubmVjdEFuaW1hdGVkVmlldygpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHNldE5hdGl2ZVZpZXcoYW5pbWF0ZWRWaWV3OiBhbnkpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5fYW5pbWF0ZWRWaWV3ID09PSBhbmltYXRlZFZpZXcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5fYW5pbWF0ZWRWaWV3ID0gYW5pbWF0ZWRWaWV3O1xuICAgIGlmICh0aGlzLl9faXNOYXRpdmUpIHtcbiAgICAgIHRoaXMuX19jb25uZWN0QW5pbWF0ZWRWaWV3KCk7XG4gICAgfVxuICB9XG5cbiAgX19jb25uZWN0QW5pbWF0ZWRWaWV3KCk6IHZvaWQge1xuICAgIGludmFyaWFudCh0aGlzLl9faXNOYXRpdmUsICdFeHBlY3RlZCBub2RlIHRvIGJlIG1hcmtlZCBhcyBcIm5hdGl2ZVwiJyk7XG4gICAgY29uc3QgbmF0aXZlVmlld1RhZzogP251bWJlciA9IGZpbmROb2RlSGFuZGxlKHRoaXMuX2FuaW1hdGVkVmlldyk7XG4gICAgaW52YXJpYW50KFxuICAgICAgbmF0aXZlVmlld1RhZyAhPSBudWxsLFxuICAgICAgJ1VuYWJsZSB0byBsb2NhdGUgYXR0YWNoZWQgdmlldyBpbiB0aGUgbmF0aXZlIHRyZWUnLFxuICAgICk7XG4gICAgTmF0aXZlQW5pbWF0ZWRIZWxwZXIuQVBJLmNvbm5lY3RBbmltYXRlZE5vZGVUb1ZpZXcoXG4gICAgICB0aGlzLl9fZ2V0TmF0aXZlVGFnKCksXG4gICAgICBuYXRpdmVWaWV3VGFnLFxuICAgICk7XG4gIH1cblxuICBfX2Rpc2Nvbm5lY3RBbmltYXRlZFZpZXcoKTogdm9pZCB7XG4gICAgaW52YXJpYW50KHRoaXMuX19pc05hdGl2ZSwgJ0V4cGVjdGVkIG5vZGUgdG8gYmUgbWFya2VkIGFzIFwibmF0aXZlXCInKTtcbiAgICBjb25zdCBuYXRpdmVWaWV3VGFnOiA/bnVtYmVyID0gZmluZE5vZGVIYW5kbGUodGhpcy5fYW5pbWF0ZWRWaWV3KTtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBuYXRpdmVWaWV3VGFnICE9IG51bGwsXG4gICAgICAnVW5hYmxlIHRvIGxvY2F0ZSBhdHRhY2hlZCB2aWV3IGluIHRoZSBuYXRpdmUgdHJlZScsXG4gICAgKTtcbiAgICBOYXRpdmVBbmltYXRlZEhlbHBlci5BUEkuZGlzY29ubmVjdEFuaW1hdGVkTm9kZUZyb21WaWV3KFxuICAgICAgdGhpcy5fX2dldE5hdGl2ZVRhZygpLFxuICAgICAgbmF0aXZlVmlld1RhZyxcbiAgICApO1xuICB9XG5cbiAgX19yZXN0b3JlRGVmYXVsdFZhbHVlcygpOiB2b2lkIHtcbiAgICAvLyBXaGVuIHVzaW5nIHRoZSBuYXRpdmUgZHJpdmVyLCB2aWV3IHByb3BlcnRpZXMgbmVlZCB0byBiZSByZXN0b3JlZCB0b1xuICAgIC8vIHRoZWlyIGRlZmF1bHQgdmFsdWVzIG1hbnVhbGx5IHNpbmNlIHJlYWN0IG5vIGxvbmdlciB0cmFja3MgdGhlbS4gVGhpc1xuICAgIC8vIGlzIG5lZWRlZCB0byBoYW5kbGUgY2FzZXMgd2hlcmUgYSBwcm9wIGRyaXZlbiBieSBuYXRpdmUgYW5pbWF0ZWQgaXMgcmVtb3ZlZFxuICAgIC8vIGFmdGVyIGhhdmluZyBiZWVuIGNoYW5nZWQgbmF0aXZlbHkgYnkgYW4gYW5pbWF0aW9uLlxuICAgIGlmICh0aGlzLl9faXNOYXRpdmUpIHtcbiAgICAgIE5hdGl2ZUFuaW1hdGVkSGVscGVyLkFQSS5yZXN0b3JlRGVmYXVsdFZhbHVlcyh0aGlzLl9fZ2V0TmF0aXZlVGFnKCkpO1xuICAgIH1cbiAgfVxuXG4gIF9fZ2V0TmF0aXZlQ29uZmlnKCk6IE9iamVjdCB7XG4gICAgY29uc3QgcHJvcHNDb25maWc6IHtbc3RyaW5nXTogbnVtYmVyfSA9IHt9O1xuICAgIGZvciAoY29uc3QgcHJvcEtleSBpbiB0aGlzLl9wcm9wcykge1xuICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLl9wcm9wc1twcm9wS2V5XTtcbiAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFuaW1hdGVkTm9kZSkge1xuICAgICAgICB2YWx1ZS5fX21ha2VOYXRpdmUodGhpcy5fX2dldFBsYXRmb3JtQ29uZmlnKCkpO1xuICAgICAgICBwcm9wc0NvbmZpZ1twcm9wS2V5XSA9IHZhbHVlLl9fZ2V0TmF0aXZlVGFnKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAncHJvcHMnLFxuICAgICAgcHJvcHM6IHByb3BzQ29uZmlnLFxuICAgIH07XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6IkFBVUEsWUFBWTs7QUFBQyxJQUFBQSxzQkFBQSxHQUFBQyxPQUFBO0FBQUFDLE1BQUEsQ0FBQUMsY0FBQSxDQUFBQyxPQUFBO0VBQUFDLEtBQUE7QUFBQTtBQUFBRCxPQUFBLENBQUFFLE9BQUE7QUFBQSxJQUFBQyxnQkFBQSxHQUFBUCxzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUFBQU8sYUFBQSxHQUFBUixzQkFBQSxDQUFBQyxPQUFBO0FBQUEsSUFBQVEsMkJBQUEsR0FBQVQsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFTLEtBQUEsR0FBQVYsc0JBQUEsQ0FBQUMsT0FBQTtBQUFBLElBQUFVLGdCQUFBLEdBQUFYLHNCQUFBLENBQUFDLE9BQUE7QUFBQSxJQUFBVyxVQUFBLEdBQUFaLHNCQUFBLENBQUFDLE9BQUE7QUFJYixJQUFBWSxjQUFBLEdBQUFaLE9BQUE7QUFDQSxJQUFBYSxj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